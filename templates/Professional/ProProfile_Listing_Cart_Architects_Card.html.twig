{% if ProProfile.CompanyName is defined %}
<div class="profile-card">
    <div class="profile-header">
        <div class="profile-image"> 
            {% if ProProfile.ProfileImage %} 
                {{ ProProfile.ProfileImage.thumbnail('Architects').html | raw }}
            {% else %}
                {% set defaultImage = "/static/images/default.png" %}
                {% set image = pimcore_asset(defaultImage) %}
                {{ pimcore_asset_by_path('/Static/DefaultImage.jpeg').thumbnail('Architects').html|raw }}
            {% endif %}  
        </div>
        <div class="profile-info">
            <div class="profile-name">
                {% if listingtype == 'Contractor' %}
                <a href="/contractor/portfolio/{{ ProProfile.getKey() }}">{{ ProProfile.getCompanyName() }}</a>
                {% endif %}
                {% if listingtype == 'Designer' %}
                <a href="/designer/portfolio/{{ ProProfile.getKey() }}">{{ ProProfile.getCompanyName() }}</a>
                {% endif %}
                {% if listingtype == 'Architect' %}
                <a href="/architect/portfolio/{{ ProProfile.getKey() }}">{{ ProProfile.getCompanyName() }}</a>
                {% endif %}
                {% if listingtype == 'Builder' %}
                <a href="/builder/portfolio/{{ ProProfile.getKey() }}">{{ ProProfile.getCompanyName() }}</a>
                {% endif %}
                {% if listingtype == 'Manufacturer' %}
                <a href="/manufacturer/portfolio/{{ ProProfile.getKey() }}">{{ ProProfile.getCompanyName() }}</a>
                {% endif %}
                {% if listingtype == 'Engineer' %}
                <a href="/engineer/portfolio/{{ ProProfile.getKey() }}">{{ ProProfile.getCompanyName() }}</a>
                {% endif %}
            </div>
            <div class="profile-description">
                {% if listingtype == 'Contractor' %}
                    <p>{{ ProProfile.getDescription()|slice(0, 150) }}{% if ProProfile.getDescription()|length > 150 %}... <a href="/contractor/portfolio/{{ ProProfile.getKey() }}">Read More</a>{% endif %}</p>
                {% endif %}
                {% if listingtype == 'Designer' %}
                    <p>{{ ProProfile.getDescription()|slice(0, 150) }}{% if ProProfile.getDescription()|length > 150 %}... <a href="/designer/portfolio/{{ ProProfile.getKey() }}">Read More</a>{% endif %}</p>
                {% endif %}
                {% if listingtype == 'Architect' %}
                    <p>{{ ProProfile.getDescription()|slice(0, 150) }}{% if ProProfile.getDescription()|length > 150 %}... <a href="/architect/portfolio/{{ ProProfile.getKey() }}">Read More</a>{% endif %}</p>
                {% endif %}
                {% if listingtype == 'Builder' %}
                    <p>{{ ProProfile.getDescription()|slice(0, 150) }}{% if ProProfile.getDescription()|length > 150 %}... <a href="/builder/portfolio/{{ ProProfile.getKey() }}">Read More</a>{% endif %}</p>
                {% endif %}
                {% if listingtype == 'Manufacturer' %}
                    <p>{{ ProProfile.getDescription()|slice(0, 150) }}{% if ProProfile.getDescription()|length > 150 %}... <a href="/manufacturer/portfolio/{{ ProProfile.getKey() }}">Read More</a>{% endif %}</p>
                {% endif %}
                {% if listingtype == 'Engineer' %}
                    <p>{{ ProProfile.getDescription()|slice(0, 150) }}{% if ProProfile.getDescription()|length > 150 %}... <a href="/engineer/portfolio/{{ ProProfile.getKey() }}">Read More</a>{% endif %}</p>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="profile-stats">
        <div class="stat-item">
            <i class="fa fa-calendar"></i>
            <span>{{ ProProfile.getYearEstablished() }}</span>
            <small>Est. Year</small>
        </div>
        {% if listingtype != 'Manufacturer' %}
            <div class="stat-item">
                <i class="fa fa-rocket"></i>
                <span>{{ ProProfile.getProjectsNumber() }}</span>
                <small>{{ ProProfile.getProjectsNumber() <= 1 ? 'Project' : 'Projects' }}</small>
            </div>
        {% endif %}
        {% if listingtype == 'Manufacturer' %}
            <div class="stat-item">
                <i class="fa fa-rocket"></i>
                <span>{{ ProProfile.getProductsNumber() }}</span>
                <small>{{ ProProfile.getProductsNumber() <= 1 ? 'Product' : 'Products' }}</small>
            </div>
        {% endif %}
    </div>
    
    <div class="rating-section">
        <div class="stars">
            {% set rating = ProProfile.getCalculatedRating() %}
            {% set fullStars = rating | round(0, 'floor') %}
            {% set hasHalfStar = (rating - fullStars) >= 0.5 %}
            
            {% for i in range(1, 5) %}
                {% if i <= fullStars %}
                    <span class="star filled">★</span>
                {% elseif hasHalfStar and i == fullStars + 1 %}
                    <span class="star half">☆</span>
                {% else %}
                    <span class="star empty">☆</span>
                {% endif %}
            {% endfor %}
        </div>
    </div>
    
    <div class="profile-actions">
        {% if listingtype == 'Contractor' %}
            <a href="/contractor/portfolio/{{ ProProfile.getKey() }}" class="view-button">
                <i class="fa fa-eye"></i>
                View Profile
            </a>
        {% endif %}
        {% if listingtype == 'Designer' %}
            <a href="/designer/portfolio/{{ ProProfile.getKey() }}" class="view-button">
                <i class="fa fa-eye"></i>
                View Profile
            </a>
        {% endif %}
        {% if listingtype == 'Architect' %}
            <a href="/architect/portfolio/{{ ProProfile.getKey() }}" class="view-button">
                <i class="fa fa-eye"></i>
                View Profile
            </a>
        {% endif %}
        {% if listingtype == 'Builder' %}
            <a href="/builder/portfolio/{{ ProProfile.getKey() }}" class="view-button">
                <i class="fa fa-eye"></i>
                View Profile
            </a>
        {% endif %}
        {% if listingtype == 'Manufacturer' %}
            <a href="/manufacturer/portfolio/{{ ProProfile.getKey() }}" class="view-button">
                <i class="fa fa-eye"></i>
                View Profile
            </a>
        {% endif %}
        {% if listingtype == 'Engineer' %}
            <a href="/engineer/portfolio/{{ ProProfile.getKey() }}" class="view-button">
                <i class="fa fa-eye"></i>
                View Profile
            </a>
        {% endif %}
    </div>
</div>
{% else %}

<!-- From Scraped Database -->
<div class="profile-card">
    <div class="profile-header">
        <div class="profile-image"> 
            {% if listingtype == 'Architect' %}
                {{ pimcore_asset_by_path('/Static/architects-default.jpeg').thumbnail('Architects').html|raw }}
            {% endif %}
            {% if listingtype == 'Builder' %}
                {{ pimcore_asset_by_path('/Static/Builder-Default.jpeg').thumbnail('Architects').html|raw }}
            {% endif %}
            {% if listingtype == 'Engineer' %}
                {{ pimcore_asset_by_path('/Static/Engineer-default.jpeg').thumbnail('Architects').html|raw }}
            {% endif %}
            {% if listingtype == 'EarthMovers' %}
                {{ pimcore_asset_by_path('/Static/Earth-Movers.jpg').thumbnail('Architects').html|raw }}
            {% endif %}
        </div>
        <div class="profile-info">
            <div class="profile-name">
                <a href="javascript:void(0)">{{ ProProfile.Name }}</a>
            </div>
            <div class="profile-description">
                {% if listingtype == 'Architect' %}
                    <p>Architect Registration No: {{ ProProfile.Registered_Architect_No }}</p>
                {% endif %}
                {% if listingtype == 'Engineer' %}
                    <p>Registration No: {{ ProProfile.Reg_No }}</p>
                {% endif %}
                {% if listingtype == 'Builder' %}
                    <p>Registration No: {{ ProProfile.Reg_No }}</p>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="profile-stats">
        {% if listingtype == 'EarthMovers' %}
            <div class="stat-item">
                <i class="fa fa-calendar"></i>
                <span>{{ ProProfile.year_of_establishment }}</span>
                <small>Est. Year</small>
            </div>
        {% else %}
            <div class="stat-item">
                <i class="fa fa-calendar"></i>
                <span>-</span>
                <small>Est. Year</small>
            </div>
        {% endif %}
        
        <div class="stat-item">
            <i class="fa fa-rocket"></i>
            <span>-</span>
            <small>Projects</small>
        </div>
    </div>
    
    <div class="rating-section">
        <div class="stars">
            {% set rating = 0 %}
            {% set fullStars = rating | round(0, 'floor') %}
            {% set hasHalfStar = (rating - fullStars) >= 0.5 %}
            
            {% for i in range(1, 5) %}
                {% if i <= fullStars %}
                    <span class="star filled">★</span>
                {% elseif hasHalfStar and i == fullStars + 1 %}
                    <span class="star half">☆</span>
                {% else %}
                    <span class="star empty">☆</span>
                {% endif %}
            {% endfor %}
        </div>
    </div>
    
    <div class="profile-actions">
        <a href="javascript:void(0)" class="view-button">
            <i class="fa fa-eye"></i>
            View Profile
        </a>
    </div>
</div>

{% endif %}